<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- Copyright 2015-03-04T11:02:21-03:30, Rod Byrne --><title>ajax</title>
<link rel="stylesheet" href="../css/online.css" type="text/css">
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
</head>
<body><div class="notes">
<div class="slide">
<h1>Databases in Java</h1>
<div>
<p>
        The <tt>UserAuthDBManger</tt> class provides a demonstration
        of using a <a href="http://www.sqlite.org/">Sqlite</a>
        data base with Java.
    </p>
<p>
        Java uses the <tt>java.sql</tt> and <tt>javax.sql</tt>
        packages to access SQL databases. The Java standard is called
        <tt>JDBC</tt>, Java Data Base Connectivity.
    </p>
<p>
        To use the <tt>Sqlite</tt> data base, the <tt>sqlite</tt> 
        drive must be loaded. It is loaded with:
    </p>
<h2 class="src-name"><a href="code/src/UserAuthDBManger.java">code/src/UserAuthDBManger.java</a></h2>
<div class="highlight"><pre><span class="c1">// try loading sqlite</span>
<span class="kd">static</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"org.sqlite.JDBC"</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">catch</span><span class="o">(</span> <span class="n">Exception</span> <span class="n">ex</span> <span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()</span> <span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span> <span class="mi">0</span> <span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
<p>
        A <tt>static</tt> block outside of any method is 
        run when the class is loaded. The class is only loaded once.
    </p>
</div>
</div>
<div class="slide">
<h1>SQL statements in Java</h1>
<div>
<p>
        The <tt>UserAuthDBManger</tt> class is responsible
        for retrieving, deleting, and changing user records
        that allow user authentication. Each of
        these responsiblities require one of the following
        SQL statements.
    </p>
<h2 class="src-name"><a href="code/src/UserAuthDBManger.java">code/src/UserAuthDBManger.java</a></h2>
<div class="highlight"><pre><span class="c1">// create the users table, each user id must be unique</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">createUserTable</span> <span class="o">=</span> 
    <span class="s">"CREATE TABLE IF NOT EXISTS Users "</span> <span class="o">+</span>
    <span class="s">"(key INTEGER PRIMARY KEY, id TEXT UNIQUE, "</span> <span class="o">+</span>
    <span class="s">"pw TEXT, name TEXT, role TEXT)"</span><span class="o">;</span>

<span class="c1">// find a particular user</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">selectByUser</span> <span class="o">=</span> 
    <span class="s">"SELECT * FROM Users WHERE id = ?"</span><span class="o">;</span>

<span class="c1">// add a new user</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">insertIntoUser</span> <span class="o">=</span> 
    <span class="s">"INSERT INTO Users VALUES(NULL, ?, ?, ?, ?)"</span><span class="o">;</span>

<span class="c1">// change a user's password</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">updatePassword</span> <span class="o">=</span> 
    <span class="s">"UPDATE Users set pw=? where id=?"</span><span class="o">;</span>

<span class="c1">// change a user's role</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">updateRole</span> <span class="o">=</span> 
    <span class="s">"UPDATE Users set role=? where id=?"</span><span class="o">;</span>

<span class="c1">// delete a user</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">deleteUser</span> <span class="o">=</span> 
    <span class="s">"DELETE FROM Users where id=?"</span><span class="o">;</span>
</pre></div>
<p>
        The <tt>?</tt> in the strings acts as place holders
        that indicate parts of the statement that should
        be replaced. <b>The is the only way SQL statements should
        be modified.</b></p>
<p>
        For example, the delete user could be implemented by:
    </p>
<div class="highlight"><pre><span class="n">String</span> <span class="n">id</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">String</span> <span class="n">stmt</span> <span class="o">=</span> <span class="s">"DELETE FROM Users where id= "</span> <span class="o">+</span> <span class="n">id</span><span class="o">;</span>
</pre></div>
<p>
        Where the <tt>id</tt> variable contains the name of the 
        users. However the <tt>id</tt> could be replaced by:
    </p>
<div class="highlight"><pre><span class="n">String</span> <span class="n">id</span> <span class="o">=</span> <span class="s">"foo; select * from Users;"</span>
</pre></div>
<p>
        This could result in a display of the entire data base.
        The above is called an SQL injection attack.
    </p>
</div>
</div>
<div class="slide">
<h1>try-with-resources Java Statement</h1>
<div>
<p>
        Access to a database is simplified with the
        the <tt>try-with-resources</tt> 
        block. This block can be used with any
        class that implements the <tt>java.lang.AutoCloseable</tt>
        interface. The <tt>try-with-resources</tt>
        ensures that any resources are released
        at the end of the block. Most SQL requests
        require resource allocation.
    </p>
<p>
        The <tt>UserAuthDBManger</tt> constructor
        ensures that the database has a <tt>users</tt> table.
    </p>
<h2 class="src-name"><a href="code/src/UserAuthDBManger.java">code/src/UserAuthDBManger.java</a></h2>
<div class="highlight"><pre><span class="kd">public</span> <span class="nf">UserAuthDBManger</span><span class="o">(</span> <span class="n">String</span> <span class="n">dbPath</span><span class="o">,</span> <span class="kt">int</span> <span class="n">timeout</span> <span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">dbURL</span> <span class="o">=</span> <span class="s">"jdbc:sqlite:"</span> <span class="o">+</span> <span class="n">dbPath</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">timeout</span> <span class="o">=</span> <span class="n">timeout</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">(</span>
        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span> <span class="n">dbURL</span> <span class="o">);</span>
        <span class="n">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span> <span class="n">createUserTable</span> <span class="o">);</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setQueryTimeout</span><span class="o">(</span><span class="n">timeout</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
<p>
        The <tt>( )</tt> between the <tt>try</tt> and the
        opening brace <tt>{</tt>
        contain object declarations for a database connection,
        and a database statement. These objects will release
        any resources after the block is finished by calling
        their <tt>close</tt> methods.
        This includes the case when an exception is thrown.
    </p>
<p>
       The <tt>conn</tt> is required to connect 
       to the database. The <tt>stmt</tt> object
       contains a SQL statement, that is then
       executed by the <tt>stmt.executeUpdate()</tt> method.
    </p>
</div>
</div>
<div class="slide">
<h1>Looking up a user</h1>
<div>
<p>
        A user is searched for with their <tt>id</tt>
        using a <tt>SELECT</tt> SQL statement.
        Executing this statement can result in no users.
        If <tt>rs.next() </tt> false then
        no user was found.
    </p>
<h2 class="src-name"><a href="code/src/UserAuthDBManger.java">code/src/UserAuthDBManger.java</a></h2>
<div class="highlight"><pre><span class="kd">public</span> <span class="n">User</span> <span class="nf">getUserById</span><span class="o">(</span> <span class="n">String</span> <span class="n">id</span> <span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">(</span>
        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span> <span class="n">dbURL</span> <span class="o">);</span>
        <span class="n">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span> <span class="n">selectByUser</span> <span class="o">);</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setQueryTimeout</span><span class="o">(</span><span class="n">timeout</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">id</span> <span class="o">);</span>
        <span class="n">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span> <span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"id"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">pw</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"pw"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">role</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"role"</span><span class="o">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">User</span><span class="o">(</span> <span class="n">nid</span><span class="o">,</span> <span class="n">pw</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">role</span> <span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
<p>
        The <tt>?</tt> in the <tt>selectByUser</tt>
        string is a place holder for the <tt>id</tt> to search.
        It is set with <tt>stmt.setString(1, id );</tt>.
        The <tt>1</tt> argument references its position
        in the string. In this case there is only one place
        holder.
    </p>
<p>
        The <tt>stmt.executeQuery()</tt> method is used
        when a query makes no changes to the database,
        but returns a result.
    </p>
<p>
        Care should be taken to ensure that names of
        the table columns match with the actual column name.
        The resources used by <tt>rs</tt>, can
        be explictly closed, or can be closed by <tt>stmt</tt>
        when <tt>stmt</tt> is closed.
    </p>
</div>
</div>
<div class="slide">
<h1>Adding a new user</h1>
<div>
<p>
        The <tt>addUser</tt> method is:
    </p>
<h2 class="src-name"><a href="code/src/UserAuthDBManger.java">code/src/UserAuthDBManger.java</a></h2>
<div class="highlight"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">addUser</span><span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">,</span> <span class="n">String</span> <span class="n">password</span><span class="o">,</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">role</span><span class="o">)</span>
    <span class="kd">throws</span> <span class="n">SQLException</span>
<span class="o">{</span>
    <span class="k">try</span> <span class="o">(</span>
        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span> <span class="n">dbURL</span> <span class="o">);</span>
        <span class="n">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span> <span class="n">insertIntoUser</span> <span class="o">);</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setQueryTimeout</span><span class="o">(</span><span class="n">timeout</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">name</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">role</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
<p>
        There are 4 <tt>?</tt> place holders in
        the <tt>insertIntoUser</tt> SQL statement.
        Each row entry is set by a call to
        <tt>stmt.setString(pos, value)</tt>,
        where <tt>pos</tt> matches the position
        in the <tt>insertIntoUser</tt> string.
    </p>
<p>
        The <tt>stmt.executeUpdate()</tt> updates
        the database.
    </p>
</div>
</div>
<div class="slide">
<h1>Remaining database methods are:</h1>
<div>
<h2 class="src-name"><a href="code/src/UserAuthDBManger.java">code/src/UserAuthDBManger.java</a></h2>
<div class="highlight"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">changePassword</span><span class="o">(</span> <span class="n">String</span> <span class="n">id</span><span class="o">,</span> <span class="n">String</span> <span class="n">password</span> <span class="o">)</span>
    <span class="kd">throws</span> <span class="n">SQLException</span>
<span class="o">{</span>
    <span class="k">try</span> <span class="o">(</span>
        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span> <span class="n">dbURL</span> <span class="o">);</span>
        <span class="n">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span> <span class="n">updatePassword</span> <span class="o">);</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setQueryTimeout</span><span class="o">(</span><span class="n">timeout</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
<h2 class="src-name"><a href="code/src/UserAuthDBManger.java">code/src/UserAuthDBManger.java</a></h2>
<div class="highlight"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeRole</span><span class="o">(</span> <span class="n">String</span> <span class="n">id</span><span class="o">,</span> <span class="n">String</span> <span class="n">role</span> <span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">(</span>
        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span> <span class="n">dbURL</span> <span class="o">);</span>
        <span class="n">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span> <span class="n">updateRole</span> <span class="o">);</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setQueryTimeout</span><span class="o">(</span><span class="n">timeout</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">role</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
<h2 class="src-name"><a href="code/src/UserAuthDBManger.java">code/src/UserAuthDBManger.java</a></h2>
<div class="highlight"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteUser</span><span class="o">(</span> <span class="n">String</span> <span class="n">id</span> <span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">(</span>
        <span class="n">Connection</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span> <span class="n">dbURL</span> <span class="o">);</span>
        <span class="n">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span> <span class="n">deleteUser</span> <span class="o">);</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setQueryTimeout</span><span class="o">(</span><span class="n">timeout</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
        <span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
<p>
        In all these methods, the <tt>try-with-resources</tt>
        block is used.
    </p>
</div>
</div>
<div class="slide">
<h1>Representational State Transfer (REST) Architecture</h1>
<div>
<p>
        Scalable web application can be created using the 
        REST Architecture. Briefly, this architecture uses URLs to
        represent resources. The HTTP methods of GET, PUT, POST, or DELETE,
        along with messages encoded with JSON or XML are used to make
        changes or queries to these resources. 
    </p>
<p>
        Google <tt>rest architecture</tt> to find out more.
    </p>
<p>
        The <tt>DbRest</tt> implements a <em>Restful</em> architecture
        that access the user authication database through
        <tt>UserAuthDBManger</tt>.
    </p>
<p>
        The URL, <tt>/db/user/:user</tt> represents the user
        resource. A GET request returns the resource (i.e., A JSON
        message containing all the user information.
        A POST request, containing a JSON message, is used
        to add user. A user is deleted with a DELETE request.
        A user's password and role is changed with a PUT request.
    </p>
</div>
</div>
<div class="slide">
<h1>GET user</h1>
<div>
<p>
        The Spark lambda code for handling the GET request
        that queries a user is:
    </p>
<h2 class="src-name"><a href="code/src/DbRest.java">code/src/DbRest.java</a></h2>
<div class="highlight"><pre><span class="c1">// Retrieve a user</span>
<span class="n">get</span><span class="o">(</span><span class="s">"/db/user/:user"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">response</span><span class="o">.</span><span class="na">type</span><span class="o">(</span><span class="s">"application/json"</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">uid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">params</span><span class="o">(</span><span class="s">":user"</span><span class="o">);</span>
        <span class="n">UserAuthDBManger</span><span class="o">.</span><span class="na">User</span> <span class="n">u</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="na">getUserById</span><span class="o">(</span> <span class="n">uid</span> <span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span> <span class="n">u</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">u</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">uid</span> <span class="o">+</span> <span class="s">" is unknown"</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">catch</span><span class="o">(</span> <span class="n">SQLException</span> <span class="n">ex</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">},</span> <span class="k">new</span> <span class="n">JsonTransformer</span><span class="o">()</span> <span class="o">);</span>
</pre></div>
<p>
        The <tt>com.google.gson.Gson</tt> package
        is used to convert the <tt>User</tt> object
        into a JSON message.
    </p>
<p><tt>curl</tt> is used to test the GET code.
        A bash script that does this is:
    </p>
<h2 class="src-name"><a href="code/get_user.sh">code/get_user.sh</a></h2>
<div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="k">function </span>get_user <span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$# </span>-ne 1 <span class="o">]</span>; <span class="k">then</span>
<span class="k">        </span><span class="nb">echo</span> <span class="s2">"missing user"</span>
        <span class="k">return </span>1
    <span class="k">fi</span>
<span class="k">    </span>curl -X GET <span class="s2">"http://localhost:4567/db/user/$1"</span>
<span class="o">}</span>

get_user <span class="s2">"$@"</span>; <span class="nv">st</span><span class="o">=</span><span class="nv">$?</span>
<span class="nb">echo</span>
<span class="nb">exit</span> <span class="nv">$st</span>
</pre></div>
</div>
</div>
<div class="slide">
<h1>POST user</h1>
<div>
<p>
        The post handler that creates a user is:
    </p>
<h2 class="src-name"><a href="code/src/DbRest.java">code/src/DbRest.java</a></h2>
<div class="highlight"><pre><span class="c1">// Create a user</span>
<span class="n">post</span><span class="o">(</span><span class="s">"/db/user/:user"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">response</span><span class="o">.</span><span class="na">type</span><span class="o">(</span><span class="s">"application/json"</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">uid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">params</span><span class="o">(</span><span class="s">":user"</span><span class="o">);</span>
    <span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Gson</span><span class="o">();</span>
    <span class="n">String</span> <span class="n">b</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">body</span><span class="o">();</span>
    <span class="n">UserAuthDBManger</span><span class="o">.</span><span class="na">User</span> <span class="n">u</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">UserAuthDBManger</span><span class="o">.</span><span class="na">User</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">catch</span><span class="o">(</span> <span class="n">JsonParseException</span> <span class="n">ex</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"not a valid json body"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">db</span><span class="o">.</span><span class="na">addUser</span><span class="o">(</span> <span class="n">u</span><span class="o">.</span><span class="na">id</span><span class="o">,</span> <span class="n">u</span><span class="o">.</span><span class="na">password</span><span class="o">,</span> <span class="n">u</span><span class="o">.</span><span class="na">name</span><span class="o">,</span> <span class="n">u</span><span class="o">.</span><span class="na">role</span> <span class="o">);</span>
    <span class="o">}</span>
    <span class="k">catch</span><span class="o">(</span> <span class="n">SQLException</span> <span class="n">ex</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">u</span><span class="o">;</span>
<span class="o">},</span> <span class="k">new</span> <span class="n">JsonTransformer</span><span class="o">()</span> <span class="o">);</span>
</pre></div>
<p>
        JSON is used to send the new user and JSON is 
        also used to return the user information.
        Any errors are returned in a JSON string.
    </p>
<p>
        The <tt>curl</tt> code to add a user is:
    </p>
<h2 class="src-name"><a href="code/create_user.sh">code/create_user.sh</a></h2>
<div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="k">function </span>create_user <span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$# </span>-ne 4 <span class="o">]</span>; <span class="k">then</span>
<span class="k">        </span><span class="nb">echo</span> <span class="s2">"usage: create_user id password name role"</span>
        <span class="k">return </span>1
    <span class="k">fi</span>

<span class="k">    </span><span class="nb">local </span><span class="nv">u</span><span class="o">=</span><span class="s2">"\"id\":\"$1\""</span>
    <span class="nb">local </span><span class="nv">p</span><span class="o">=</span><span class="s2">"\"password\":\"$2\""</span>
    <span class="nb">local </span><span class="nv">n</span><span class="o">=</span><span class="s2">"\"name\":\"$3\""</span>
    <span class="nb">local </span><span class="nv">r</span><span class="o">=</span><span class="s2">"\"role\":\"$4\""</span>
    curl -X POST -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
    -d <span class="s2">"{$u,$p,$n,$r}"</span> <span class="se">\</span>
    <span class="s2">"http://localhost:4567/db/user/$1"</span>
<span class="o">}</span>

create_user <span class="s2">"$@"</span> ; <span class="nv">st</span><span class="o">=</span><span class="nv">$?</span>
<span class="nb">echo</span>
<span class="nb">exit</span> <span class="nv">$st</span>
</pre></div>
</div>
</div>
<div class="slide">
<h1>DELETE and PUT requests</h1>
<div>
<p>
        The code to delete a user is:
    </p>
<h2 class="src-name"><a href="code/src/DbRest.java">code/src/DbRest.java</a></h2>
<div class="highlight"><pre><span class="c1">// Delete a user</span>
<span class="n">delete</span><span class="o">(</span><span class="s">"/db/user/:user"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">response</span><span class="o">.</span><span class="na">type</span><span class="o">(</span><span class="s">"application/json"</span><span class="o">);</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">uid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">params</span><span class="o">(</span><span class="s">":user"</span><span class="o">);</span>
        <span class="n">UserAuthDBManger</span><span class="o">.</span><span class="na">User</span> <span class="n">u</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="na">getUserById</span><span class="o">(</span> <span class="n">uid</span> <span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span> <span class="n">u</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">db</span><span class="o">.</span><span class="na">deleteUser</span><span class="o">(</span><span class="n">uid</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">u</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">uid</span> <span class="o">+</span> <span class="s">" is unknown"</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">catch</span><span class="o">(</span> <span class="n">SQLException</span> <span class="n">ex</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">},</span> <span class="k">new</span> <span class="n">JsonTransformer</span><span class="o">()</span> <span class="o">);</span>
</pre></div>
<p>
        The bash script tp test delete is:
    </p>
<h2 class="src-name"><a href="code/delete_user.sh">code/delete_user.sh</a></h2>
<div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="k">function </span>delete_user <span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nv">$# </span>-ne 1 <span class="o">]</span>; <span class="k">then</span>
<span class="k">        </span><span class="nb">echo</span> <span class="s2">"missing user"</span>
        <span class="k">return </span>1
    <span class="k">fi</span>
<span class="k">    </span>curl -X DELETE <span class="s2">"http://localhost:4567/db/user/$1"</span>
<span class="o">}</span>

delete_user <span class="s2">"$@"</span>; <span class="nv">st</span><span class="o">=</span><span class="nv">$?</span>
<span class="nb">echo</span>
<span class="nb">exit</span> <span class="nv">$st</span>
</pre></div>
<p>
        The code to change a user's properties is:
    </p>
<h2 class="src-name"><a href="code/src/DbRest.java">code/src/DbRest.java</a></h2>
<div class="highlight"><pre><span class="c1">// Update a user</span>
<span class="n">put</span><span class="o">(</span><span class="s">"/db/user/:user"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">response</span><span class="o">.</span><span class="na">type</span><span class="o">(</span><span class="s">"application/json"</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">uid</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">params</span><span class="o">(</span><span class="s">":user"</span><span class="o">);</span>
    <span class="n">UserAuthDBManger</span><span class="o">.</span><span class="na">User</span> <span class="n">u</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="na">getUserById</span><span class="o">(</span> <span class="n">uid</span> <span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span> <span class="n">u</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">uid</span> <span class="o">+</span> <span class="s">" is unknown"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Gson</span><span class="o">();</span>
    <span class="n">String</span> <span class="n">b</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">body</span><span class="o">();</span>
    <span class="n">UserAuthDBManger</span><span class="o">.</span><span class="na">User</span> <span class="n">nu</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">UserAuthDBManger</span><span class="o">.</span><span class="na">User</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">catch</span><span class="o">(</span> <span class="n">JsonParseException</span> <span class="n">ex</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"not a valid json body"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span> <span class="o">!</span> <span class="n">u</span><span class="o">.</span><span class="na">password</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span> <span class="n">nu</span><span class="o">.</span><span class="na">password</span> <span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">db</span><span class="o">.</span><span class="na">changePassword</span><span class="o">(</span> <span class="n">uid</span><span class="o">,</span> <span class="n">nu</span><span class="o">.</span><span class="na">password</span> <span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span> <span class="o">!</span> <span class="n">u</span><span class="o">.</span><span class="na">role</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span> <span class="n">nu</span><span class="o">.</span><span class="na">role</span> <span class="o">)</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">db</span><span class="o">.</span><span class="na">changeRole</span><span class="o">(</span> <span class="n">uid</span><span class="o">,</span> <span class="n">nu</span><span class="o">.</span><span class="na">role</span> <span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">catch</span><span class="o">(</span> <span class="n">SQLException</span> <span class="n">ex</span> <span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">nu</span><span class="o">;</span>
<span class="o">},</span> <span class="k">new</span> <span class="n">JsonTransformer</span><span class="o">()</span> <span class="o">);</span>
</pre></div>
</div>
</div>
<div class="slide">
<h1>Testing GET with Java</h1>
<div>
<p>
        A small Java program that tests getting a user
        and decoding JSON is:
    </p>
<h2 class="src-name"><a href="code/src/GetUser.java">code/src/GetUser.java</a></h2>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">java.util.Scanner</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStreamReader</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.HttpURLConnection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.google.gson.Gson</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.gson.JsonParseException</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GetUser</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span> <span class="n">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="o">(</span><span class="s">"http://localhost:4567/db/user/"</span> <span class="o">+</span> <span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
        <span class="n">HttpURLConnection</span> <span class="n">conn</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpURLConnection</span><span class="o">)</span><span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">();</span>
        <span class="n">conn</span><span class="o">.</span><span class="na">setRequestMethod</span><span class="o">(</span><span class="s">"GET"</span><span class="o">);</span>

        <span class="n">conn</span><span class="o">.</span><span class="na">connect</span><span class="o">();</span>

        <span class="kt">int</span> <span class="n">resp</span><span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="na">getResponseCode</span><span class="o">();</span>
        <span class="n">Scanner</span> <span class="n">sc</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Scanner</span><span class="o">(</span> <span class="n">conn</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">(),</span> <span class="s">"UTF-8"</span><span class="o">);</span>
        <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="k">while</span><span class="o">(</span> <span class="n">sc</span><span class="o">.</span><span class="na">hasNextLine</span><span class="o">()</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span> <span class="n">sc</span><span class="o">.</span><span class="na">nextLine</span><span class="o">()</span> <span class="o">);</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span> <span class="sc">'\n'</span> <span class="o">);</span>
        <span class="o">}</span>
        <span class="n">sc</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="c1">// or you can use the following to read the input</span>
        <span class="c1">// String text = sc.useDelimiter("\\A").next();</span>
        <span class="c1">// this is a bit of a hack</span>

        <span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Gson</span><span class="o">();</span>
        <span class="n">User</span> <span class="n">u</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span> <span class="n">u</span> <span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">password</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
        <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">role</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">User</span><span class="o">(</span> <span class="n">String</span> <span class="n">id</span><span class="o">,</span> <span class="n">String</span> <span class="n">password</span><span class="o">,</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">role</span> <span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">role</span> <span class="o">=</span> <span class="n">role</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">id</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">password</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">role</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div></body>
</html>
